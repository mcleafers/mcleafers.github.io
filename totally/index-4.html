<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="https://use.typekit.net/voa7cqm.css" />
  <title>Totally AI!</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: "lores-12", sans-serif; background: #000; overflow: hidden; }
    #game-container { position: absolute; top: 0; left: 0; width: 960px; height: 540px; background: radial-gradient(ellipse at center, #2a0045 0%, #0d0015 100%); overflow: hidden; }
    .stars { position: absolute; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
    .star { position: absolute; background: #fff; border-radius: 50%; opacity: 0; animation: twinkle 3s infinite ease-in-out; }
    @keyframes twinkle { 0%, 100% { opacity: 0; transform: scale(0.5); } 50% { opacity: 0.8; transform: scale(1); } }
    .sparkle { position: absolute; pointer-events: none; z-index: 1; animation: sparkle-spin 4s linear infinite; }
    .chat-container { position: relative; z-index: 2; }
    @keyframes sparkle-spin { 0% { transform: rotate(0deg) scale(1); opacity: 0.6; } 50% { transform: rotate(180deg) scale(1.4); opacity: 1; } 100% { transform: rotate(360deg) scale(1); opacity: 0.6; } }
    .screen { position: absolute; top: 0; left: 0; width: 960px; height: 540px; display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 10; }
    .screen.active { display: flex; }
    @keyframes blink { 0%, 49% { opacity: 1; } 50%, 100% { opacity: 0; } }
    .cursor { display: inline-block; width: 4px; height: 90px; background: #ff4de0; margin-left: 10px; animation: blink 0.8s infinite; vertical-align: -10px; }
    .tcur { display: inline-block; width: 3px; height: 17px; background: #ff4de0; animation: blink 0.7s infinite; vertical-align: middle; margin-left: 3px; }
    .badge { font-family: "lores-12", sans-serif; font-size: 11px; letter-spacing: 4px; color: #ff4de0; text-transform: uppercase; margin-bottom: 14px; text-align: center; z-index: 2; }
    .panel { background: rgba(255,255,255,0.04); border: 2px solid rgba(255,77,224,0.3); border-radius: 18px; padding: 16px 22px; width: 760px; max-width: calc(100% - 80px); z-index: 2; }
    .btn-base { background: linear-gradient(135deg, #ff4de0 0%, #9500be 100%); border: none; border-radius: 50px; font-family: "lores-12", sans-serif; font-size: 14px; letter-spacing: 2px; color: #fff; width: 340px; padding: 12px 28px; cursor: pointer; box-shadow: 0 5px 0 #5e007a, 0 8px 22px rgba(255,77,224,0.4); opacity: 0; pointer-events: none; transform: translateY(10px); transition: transform 0.15s, box-shadow 0.15s, opacity 0.25s; z-index: 2; }
    .btn-pop.show { opacity: 1; pointer-events: all; transform: translateY(0); animation: btn-pop 0.5s ease forwards; }
    @keyframes btn-pop { 0% { transform: translateY(14px) scale(0.92); opacity: 0; } 60% { transform: translateY(-5px) scale(1.04); opacity: 1; } 100% { transform: translateY(0) scale(1); opacity: 1; } }
    .btn-base:hover { transform: translateY(-2px); box-shadow: 0 7px 0 #5e007a, 0 12px 28px rgba(255,77,224,0.5); }
    .btn-base:active { transform: translateY(2px); box-shadow: 0 3px 0 #5e007a, 0 6px 16px rgba(255,77,224,0.3); }
    .btn-base:disabled { opacity: 0.35; pointer-events: none; filter: grayscale(0.2); }
    .logo-wrap { text-align: center; margin-bottom: 40px; z-index: 2; }
    .logo-totally-ai { font-family: "lores-12", sans-serif; font-size: 110px; font-weight: 400; color: #fff; white-space: nowrap; animation: glow-pulse 2s ease-in-out infinite; }
    @keyframes glow-pulse { 0%, 100% { text-shadow: 0 0 20px rgba(255,77,224,.8), 0 0 40px rgba(255,77,224,.6), 0 0 60px rgba(255,77,224,.4); } 50% { text-shadow: 0 0 30px rgba(255,77,224,1), 0 0 60px rgba(255,77,224,.9), 0 0 100px rgba(255,77,224,.7); } }
    #s-intro { gap: 14px; }
    #twt { font-family: "lores-12", sans-serif; font-size: 20px; line-height: 2; color: #f0d0ff; }
    .hl { color: #ff4de0; } .wn { color: #ffe066; } .bye { color: #ff99ee; }
    #s-goggle { justify-content: flex-start; gap: 10px; padding: 26px 0 18px; }
    #s-goggle .badge { margin-bottom: 6px; } #s-goggle .panel { margin-top: 6px; }
    .gog-inner { display: flex; flex-direction: column; align-items: center; gap: 10px; }
    #gtxt { font-family: "lores-12", sans-serif; font-size: 20px; line-height: 1.7; color: #f0d0ff; width: 100%; }
    .goghover { position: relative; cursor: pointer; animation: gogfloat 3.5s ease-in-out infinite; }
    @keyframes gogfloat { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-12px); } }
    .gogimg { width: clamp(220px, 34vw, 320px); max-width: 100%; height: auto; display: block; filter: drop-shadow(0 8px 24px rgba(255,77,224,.4)); transition: transform 0.3s, opacity 0.4s ease; opacity: 0; transform: translateY(6px); }
    .gogimg.reveal { opacity: 1; transform: translateY(0); }
    .goghover:hover .gogimg { transform: translateY(0) scale(1.24); }
    .gogtap { font-family: "lores-12", sans-serif; font-size: 20px; color: #ff99ee; letter-spacing: 1.4px; text-align: center; opacity: 0; transform: translateY(6px); transition: opacity 0.35s ease, transform 0.35s ease; }
    .gogtap.show { opacity: 1; transform: translateY(0); }
    @keyframes gogFlash { 0% { background: rgba(255,77,224,.6); border-width: 8px; opacity: 1; } 50% { background: rgba(255,77,224,.2); border-width: 5px; opacity: 1; } 100% { background: rgba(255,77,224,0); border-width: 0px; opacity: 0; } }
    #goggle-overlay { position: absolute; top: 0; left: 0; width: 960px; height: 540px; pointer-events: none; z-index: 300; border: 8px solid rgba(255,77,224,.8); animation: gogFlash 1.4s ease forwards; }
    @keyframes toastIn { 0% { opacity: 0; transform: translateX(-50%) translateY(-16px); } 20% { opacity: 1; transform: translateX(-50%) translateY(0); } 75% { opacity: 1; transform: translateX(-50%) translateY(0); } 100% { opacity: 0; transform: translateX(-50%) translateY(-8px); } }
    #goggle-toast { position: absolute; top: 22px; left: 50%; transform: translateX(-50%); z-index: 310; padding: 10px 32px; font-family: "lores-12", sans-serif; font-size: 17px; color: #fff; letter-spacing: 2px; background: linear-gradient(135deg, #ff4de0, #9500be); border-radius: 50px; box-shadow: 0 4px 0 #5e007a, 0 8px 28px rgba(255,77,224,.5); pointer-events: none; animation: toastIn 2.2s ease forwards; }
    #s-title { gap: 16px; }
    .tc-number { font-family: "lores-12", sans-serif; font-size: 16px; letter-spacing: 5px; color: #ff4de0; text-transform: uppercase; text-align: center; }
    .tc-title { font-family: "lores-12", sans-serif; font-size: 48px; color: #ffffff; text-align: center; text-shadow: 0 0 32px rgba(255,77,224,0.75); letter-spacing: 2px; max-width: 720px; }
    .tc-desc { font-family: "lores-12", sans-serif; font-size: 20px; color: #c7a0e0; text-align: center; max-width: 600px; line-height: 1.85; }
    #s-case1 { justify-content: flex-start; padding: 14px 12px 10px; gap: 10px; }
    .chat-container { width: 940px; background: rgba(12,0,26,0.97); border: 2.5px solid rgba(255,77,224,0.32); border-radius: 18px; overflow: hidden; }
    .chat-header { background: linear-gradient(90deg, #380048, #180030); padding: 14px 18px 10px; display: flex; align-items: flex-end; justify-content: space-between; border-bottom: 2px solid rgba(255,77,224,0.28); }
    .chat-title { font-family: "lores-12", sans-serif; font-size: 16px; color: #ff4de0; letter-spacing: 2px; }
    .chat-subtitle { font-family: "lores-12", sans-serif; font-size: 12px; color: #9c6bce; }
    .flagged-badge { background: rgba(255,77,224,0.18); top: 2px; position: relative; border: 1px solid rgba(255,77,224,0.45); border-radius: 999px; padding: 5px 14px; font-family: "lores-12", sans-serif; font-size: 12px; color: #ff99ee; letter-spacing: 1px; }
    .chat-body { padding: 8px 14px 10px; }
    .instruction-strip { background: linear-gradient(90deg, rgba(90,0,140,0.5), rgba(55,0,100,0.5)); border: 1.5px solid rgba(255,77,224,0.38); border-radius: 10px; padding: 10px 14px; font-family: "lores-12", sans-serif; font-size: 13px; color: #ff99ee; margin-bottom: 8px; text-align: center; }
    .messages { display: flex; flex-direction: column; gap: 7px; max-height: 300px; overflow-y: auto; padding-right: 4px; }
    #s-case2 .messages { max-height: 360px; overflow-y: hidden; }
    .messages::-webkit-scrollbar { width: 5px; } .messages::-webkit-scrollbar-track { background: rgba(255,77,224,.1); border-radius: 3px; } .messages::-webkit-scrollbar-thumb { background: rgba(255,77,224,.4); border-radius: 3px; }
    .msg-row { display: flex; gap: 7px; align-items: flex-end; } .msg-row.is-user { flex-direction: row-reverse; }
    .avatar { width: 28px; height: 28px; border-radius: 50%; flex-shrink: 0; border: 1.5px solid rgba(255,77,224,.35); display: flex; align-items: center; justify-content: center; font-size: 13px; background: rgba(55,0,75,.8); }
    .bubble-wrap { display: flex; flex-direction: column; gap: 2px; }
    .bubble-name { font-family: "lores-12", sans-serif; font-size: 9px; color: #b39ddb; padding: 0 4px; }
    .is-user .bubble-name { text-align: right; }
    .bubble { max-width: 400px; padding: 7px 11px; border-radius: 10px; font-family: "lores-12", sans-serif; font-size: 12px; line-height: 1.45; color: #f0e0ff; transition: all 0.2s; }
    .bubble.stranger { background: rgba(45,0,72,.8); border: 1.5px solid rgba(110,0,170,.38); border-bottom-left-radius: 3px; }
    .bubble.user { background: rgba(95,0,115,.6); border: 1.5px solid rgba(255,77,224,.28); border-bottom-right-radius: 3px; }
    .bubble.clickable { cursor: pointer; } .bubble.clickable:hover { transform: scale(1.02); box-shadow: 0 0 10px rgba(255,77,224,.38); }
    .bubble.stranger.clickable[data-msg="1"], .bubble.stranger.clickable[data-msg="2"], .bubble.stranger.clickable[data-msg="3"] { animation: riskyGlow 2.6s ease-in-out infinite; }
    @keyframes riskyGlow { 0%, 100% { box-shadow: 0 0 10px rgba(255,77,224,.18), 0 0 18px rgba(255,77,224,.12); background: rgba(45,0,72,.80); } 50% { box-shadow: 0 0 18px rgba(255,77,224,.45), 0 0 34px rgba(255,77,224,.22); background: rgba(75,0,110,.58); } }
    .bubble.selected { border-color: #ff4de0 !important; border-width: 2px !important; background: rgba(255,77,224,.18) !important; box-shadow: 0 0 14px rgba(255,77,224,.5); }
    .bubble.flagged-red { border-color: #ff1a1a !important; border-width: 2px !important; background: rgba(110,0,28,.55) !important; box-shadow: 0 0 16px rgba(255,0,0,.4); }
    .bubble.correct-green { border-color: #00e676 !important; border-width: 2px !important; background: rgba(0,80,40,.55) !important; box-shadow: 0 0 16px rgba(0,230,118,.35) !important; animation: none !important; }
    .hint-strip { background: linear-gradient(90deg, rgba(60,0,0,0.7), rgba(40,0,0,0.7)); border: 1.5px solid rgba(255,60,60,0.5); border-radius: 10px; padding: 8px 14px; font-family: "lores-12", sans-serif; font-size: 12px; color: #ff9999; margin-top: 6px; text-align: center; display: none; }
    .hint-strip.show { display: block; }
    .npid-img { width: 240px; border-radius: 6px; border: 1.5px solid rgba(255,77,224,.28); margin-top: 6px; display: block; }
    .counter-row { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; padding: 10px 12px; font-family: "lores-12", sans-serif; font-size: 13px; letter-spacing: 0.5px; color: #f0d0ff; background: rgba(255,77,224,0.08); border: 1.5px solid rgba(255,77,224,0.25); border-radius: 12px; position: sticky; bottom: 8px; z-index: 20; backdrop-filter: blur(6px); }
    .counter-row span:last-child { color: #ff99ee !important; font-size: 12px !important; letter-spacing: 1px; }
    .action-bar { display: flex; justify-content: center; margin-top: 8px; }
    #s-case2 { position: relative; justify-content: flex-start; padding: 14px 12px 90px; gap: 10px; }
    #s-case2 .action-bar { position: absolute; bottom: 76px; left: 0; width: 100%; display: flex; justify-content: center; }
    .block-section { display: none; flex-direction: column; align-items: center; gap: 8px; width: 880px; }
    .block-section.show { display: flex; }
    .block-label { font-family: "lores-12", sans-serif; font-size: 14px; color: #ff99ee; text-align: center; letter-spacing: 1px; }
    .block-track { position: relative; width: 480px; height: 50px; background: rgba(38,0,58,.85); border: 2px solid rgba(255,77,224,.32); border-radius: 28px; overflow: hidden; }
    .block-fill { position: absolute; inset: 0; background: linear-gradient(90deg, #ff4de0, #9500be); opacity: 0; pointer-events: none; transition: opacity 0.3s; }
    .block-fill.go { opacity: 1; }
    .block-thumb { position: absolute; left: 6px; top: 6px; width: 38px; height: 34px; background: linear-gradient(135deg, #ff4de0, #9500be); border-radius: 20px; cursor: grab; display: flex; align-items: center; justify-content: center; font-size: 16px; box-shadow: 0 4px 10px rgba(255,77,224,.55); user-select: none; z-index: 2; }
    .block-hint { position: absolute; right: 18px; top: 50%; transform: translateY(-50%); font-family: "lores-12", sans-serif; font-size: 12px; color: rgba(255,140,220,.45); pointer-events: none; }

    /* ===== TEACHING CARDS ‚Äî 4 panels each ===== */
    .teach-overlay { position: absolute; top: 0; left: 0; width: 960px; height: 540px; background: rgba(0,0,0,0.82); display: none; align-items: center; justify-content: center; z-index: 400; }
    .teach-overlay.show { display: flex; }
    .teach-card { background: linear-gradient(135deg, #180030, #060010); border: 2.5px solid #ff4de0; border-radius: 18px; padding: 28px 34px 24px; width: 540px; box-shadow: 0 0 52px rgba(255,77,224,.45); text-align: center; animation: card-in 0.35s cubic-bezier(.22,.88,.36,1.35) both; overflow: hidden; }
    @keyframes card-in { 0% { transform: scale(0.88) translateY(20px); opacity: 0; } 100% { transform: scale(1) translateY(0); opacity: 1; } }
    .teach-dots { display: flex; gap: 8px; justify-content: center; margin-bottom: 18px; }
    .teach-dot { width: 8px; height: 8px; border-radius: 50%; background: rgba(255,77,224,.25); border: 1.5px solid rgba(255,77,224,.4); transition: all 0.35s; }
    .teach-dot.active { background: #ff4de0; box-shadow: 0 0 8px #ff4de0; }
    .teach-viewport { overflow: hidden; width: 100%; }
    /* 4 panels = width 400% */
    .teach-track { display: flex; width: 400%; transition: transform 0.42s cubic-bezier(0.4, 0, 0.2, 1); }
    .teach-panel { width: calc(100% / 4); flex-shrink: 0; text-align: center; padding: 0 4px; }
    .teach-icon { font-size: 38px; margin-bottom: 10px; display: block; }
    .teach-title { font-family: "lores-12", sans-serif; font-size: 19px; color: #ff4de0; margin-bottom: 12px; letter-spacing: 1px; }
    .teach-body { font-family: "lores-12", sans-serif; font-size: 13px; color: #d0b0f0; line-height: 1.9; text-align: left; margin-bottom: 14px; }
    .teach-body strong { color: #ff99ee; display: block; margin-bottom: 4px; }
    .teach-body .bullet { color: #f0d0ff; padding-left: 8px; display: block; }
    .teach-body .bullet::before { content: "‚Ä¢ "; color: #ff4de0; }
    .teach-note { font-family: "lores-12", sans-serif; font-size: 12px; color: #9c6bce; font-style: italic; line-height: 1.6; }
    .teach-note.danger { color: #ffe066; font-style: normal; font-weight: bold; }
    .teach-actions { margin-top: 14px; display: flex; align-items: center; justify-content: center; gap: 0; }
    .teach-seg { width: 210px; height: 46px; padding: 0; border: 1.8px solid rgba(255,77,224,.55); background: rgba(255,77,224,0.10); color: #fff; font-family: "lores-12", sans-serif; font-size: 14px; letter-spacing: 2px; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; transition: transform .12s, background .2s, box-shadow .2s, opacity .2s; }
    .teach-seg:first-child { border-radius: 12px 0 0 12px; border-right: 0; }
    .teach-seg:last-child { border-radius: 0 12px 12px 0; border-left: 0; }
    .teach-divider { width: 2px; height: 46px; background: rgba(255,77,224,.55); box-shadow: 0 0 12px rgba(255,77,224,.35); }
    .teach-seg:hover { background: rgba(255,77,224,0.18); box-shadow: 0 0 18px rgba(255,77,224,.25); transform: translateY(-1px); }
    .teach-seg:active { transform: translateY(1px); }
    .teach-seg:disabled { opacity: 0.35; cursor: default; transform: none; box-shadow: none; }

    /* ===== CASE 2 ===== */
    #s-case2 .bubble.stranger.threat { background: rgba(65,0,95,0.65); border: 1.5px solid rgba(180,0,255,0.45); box-shadow: 0 0 10px rgba(180,0,255,0.25); font-size: 11px; line-height: 1.35; padding: 6px 10px; max-width: 480px; }
    @keyframes gogglesGlow { 0%, 100% { box-shadow: 0 0 10px rgba(255,77,224,.25), 0 0 22px rgba(255,77,224,.18); border-color: rgba(255,77,224,.38); transform: translateY(0); } 50% { box-shadow: 0 0 18px rgba(255,77,224,.55), 0 0 42px rgba(255,77,224,.28); border-color: rgba(255,77,224,.75); transform: translateY(-1px); } }
    #s-case2 .video-preview { animation: gogglesGlow 2.4s ease-in-out infinite; }
    .video-preview { width: 240px; height: 150px; border-radius: 8px; border: 2px solid rgba(255,77,224,0.35); cursor: pointer; transition: all 0.3s; position: relative; overflow: hidden; margin-top: 8px; }
    .video-preview:hover { transform: scale(1.05); box-shadow: 0 0 16px rgba(255,77,224,0.5); }
    .play-icon { position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%); width: 35px; height: 35px; background: rgba(255,77,224,0.3); border: 2px solid #ff4de0; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 16px; color: #fff; }
    .video-thumb { width: 100%; height: 100%; object-fit: cover; display: block; }
    .video-fullscreen { position: absolute; top: 0; left: 0; width: 960px; height: 540px; display: none; z-index: 520; background: rgba(0,0,0,0.92); }
    .video-fullscreen.show { display: flex; flex-direction: column; }
    .video-fs-top { display: flex; align-items: center; justify-content: space-between; padding: 12px 14px; border-bottom: 1px solid rgba(255,77,224,.25); background: linear-gradient(90deg, rgba(40,0,60,.75), rgba(10,0,20,.75)); }
    .video-fs-label { font-family: "lores-12", sans-serif; font-size: 12px; letter-spacing: 2px; color: #ff99ee; text-transform: uppercase; }
    .video-fs-close { border: 1.5px solid rgba(255,77,224,.45); background: rgba(255,77,224,.12); color: #fff; border-radius: 12px; width: 36px; height: 28px; cursor: pointer; font-family: "lores-12", sans-serif; }
    #video-fs-player { width: 100%; height: calc(540px - 52px); object-fit: contain; background: #000; }
    #inspect-video-btn { opacity: 0; pointer-events: none; transform: translateY(10px); transition: opacity 0.3s, transform 0.3s; }
    #inspect-video-btn.show { opacity: 1; pointer-events: all; transform: translateY(0); }
    #s-inspect { justify-content: flex-start; padding: 14px 12px 10px; gap: 10px; }
    .inspect-img-wrap { position: relative; width: 230px; margin: 0 auto; }
    .inspect-img-wrap img { width: 230px; height: 260px; object-fit: cover; object-position: 55% 45%; border-radius: 12px; border: 2px solid rgba(255,77,224,0.3); display: block; }
    .dc { position: absolute; width: 42px; height: 42px; border-radius: 50%; border: 2.5px dashed rgba(255,77,224,0.9); transform: translate(-50%, -50%); cursor: pointer; z-index: 20; animation: dcPulse 2s ease-in-out infinite; transition: transform 0.15s; }
    .dc:hover { transform: translate(-50%, -50%) scale(1.15); }
    @keyframes dcPulse { 0%,100% { box-shadow: 0 0 8px rgba(255,77,224,0.3); border-color: rgba(255,77,224,0.75); } 50% { box-shadow: 0 0 18px rgba(255,77,224,0.7); border-color: rgba(255,77,224,1); } }
    .dc.found { border-style: solid; background: rgba(255,77,224,0.15); animation: dcFound 1.5s ease-in-out infinite; }
    @keyframes dcFound { 0%,100% { box-shadow: 0 0 12px rgba(255,77,224,0.5); } 50% { box-shadow: 0 0 26px rgba(255,77,224,0.9); } }
    .clue-modal { position: absolute; inset: 0; display: none; align-items: center; justify-content: center; z-index: 600; background: rgba(0,0,0,0.5); }
    .clue-modal.show { display: flex; }
    .clue-card { width: 500px; border-radius: 16px; padding: 24px 30px; text-align: center; background: linear-gradient(135deg, rgba(24,0,48,0.97), rgba(6,0,16,0.97)); border: 2.5px solid rgba(255,77,224,0.55); box-shadow: 0 0 50px rgba(255,77,224,0.4); animation: card-in 0.3s cubic-bezier(.22,.88,.36,1.35) both; }
    .clue-body { font-family: "lores-12", sans-serif; font-size: 15px; line-height: 1.9; color: #f0d0ff; letter-spacing: 0.5px; }
    #confirm-deepfake-btn.ready { opacity: 1 !important; pointer-events: auto !important; animation: btn-pop 0.4s ease forwards; }
    #teach-overlay-2 { position: absolute; top: 0; left: 0; width: 960px; height: 540px; background: rgba(0,0,0,0.82); display: none; align-items: center; justify-content: center; z-index: 480; }
    #teach-overlay-2.show { display: flex; }

    /* teach-track-2 also 4 panels */
    #teach-track-2 { width: 400% !important; }
    #teach-track-2 .teach-panel { width: calc(100% / 4) !important; }
    .suspend-section { display: none; flex-direction: column; align-items: center; gap: 8px; width: 880px; position: absolute; bottom: 14px; left: 50%; transform: translateX(-50%); z-index: 2; }
    .suspend-section.show { display: flex; }
    .suspend-label { font-family: "lores-12", sans-serif; font-size: 14px; color: #ff99ee; text-align: center; letter-spacing: 1px; }
    .suspend-track { position: relative; width: 480px; height: 50px; background: rgba(38,0,58,.85); border: 2px solid rgba(255,77,224,.32); border-radius: 28px; overflow: hidden; }
    .suspend-fill { position: absolute; inset: 0; background: linear-gradient(90deg, #ff4de0, #9500be); opacity: 0; pointer-events: none; transition: opacity 0.3s; }
    .suspend-fill.go { opacity: 1; }
    .suspend-thumb { position: absolute; left: 6px; top: 6px; width: 38px; height: 34px; background: linear-gradient(135deg, #ff4de0, #9500be); border-radius: 20px; cursor: grab; display: flex; align-items: center; justify-content: center; font-size: 16px; box-shadow: 0 4px 10px rgba(255,77,224,.55); user-select: none; z-index: 2; }
    .suspend-hint { position: absolute; right: 18px; top: 50%; transform: translateY(-50%); font-family: "lores-12", sans-serif; font-size: 12px; color: rgba(255,140,220,.45); pointer-events: none; }
    #s-quiz-intro { gap: 14px; }
    #qitxt { font-family: "lores-12", sans-serif; font-size: 20px; line-height: 2; color: #f0d0ff; }
    #s-quiz { justify-content: flex-start; padding: 14px 12px 10px; gap: 10px; }
    .quiz-container { width: 920px; background: rgba(12,0,26,0.97); border: 2.5px solid rgba(255,77,224,0.32); border-radius: 18px; overflow: hidden; position: relative; z-index: 2; }
    .quiz-header { background: linear-gradient(90deg, #380048, #180030); padding: 14px 18px 10px; display: flex; align-items: center; justify-content: space-between; border-bottom: 2px solid rgba(255,77,224,0.28); }
    .quiz-title-text { font-family: "lores-12", sans-serif; font-size: 16px; color: #ff4de0; letter-spacing: 2px; }
    .quiz-progress { font-family: "lores-12", sans-serif; font-size: 13px; color: #9c6bce; letter-spacing: 1px; }
    .quiz-body { padding: 12px 20px 14px; }
    .quiz-q { font-family: "lores-12", sans-serif; font-size: 15px; color: #f0d0ff; line-height: 1.6; margin-bottom: 10px; letter-spacing: 0.5px; }
    .quiz-q .q-label { color: #ff4de0; display: block; font-size: 11px; letter-spacing: 3px; margin-bottom: 6px; }
    .quiz-options { display: flex; flex-direction: column; gap: 7px; }
    .quiz-opt { display: flex; align-items: flex-start; gap: 10px; padding: 9px 14px; border-radius: 10px; cursor: pointer; border: 1.5px solid rgba(110,0,170,0.38); background: rgba(45,0,72,0.6); font-family: "lores-12", sans-serif; font-size: 13px; color: #f0e0ff; line-height: 1.4; transition: all 0.2s; user-select: none; }
    .quiz-opt:hover { border-color: rgba(255,77,224,0.55); background: rgba(75,0,110,0.5); transform: translateX(3px); }
    .quiz-opt .opt-key { color: #ff4de0; flex-shrink: 0; font-size: 12px; letter-spacing: 1px; min-width: 18px; }
    .quiz-opt.correct { border-color: #00e676 !important; background: rgba(0,80,40,0.55) !important; animation: none; }
    .quiz-opt.wrong { border-color: #ff1a1a !important; background: rgba(110,0,28,0.55) !important; animation: shake 0.4s ease; }
    @keyframes shake { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-6px)} 75%{transform:translateX(6px)} }
    .quiz-opt.disabled { opacity: 0.45; cursor: default; pointer-events: none; }
    .quiz-opt.disabled:hover { transform: none; }
    .drag-pool { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 6px; min-height: 30px; }
    .drag-zone { display: flex; flex-direction: column; gap: 5px; min-height: 32px; padding: 7px 10px; border: 1.5px dashed rgba(255,77,224,0.4); border-radius: 10px; background: rgba(30,0,50,0.4); }
    .drag-item { padding: 6px 12px; border-radius: 8px; cursor: grab; background: rgba(75,0,110,0.7); border: 1.5px solid rgba(170,0,255,0.45); font-family: "lores-12", sans-serif; font-size: 12px; color: #f0e0ff; user-select: none; transition: all 0.18s; display: flex; align-items: center; gap: 7px; }
    .drag-item:hover { border-color: rgba(255,77,224,0.7); transform: scale(1.02); }
    .drag-item.dragging { opacity: 0.4; transform: scale(0.96); }
    .drag-item.correct-item { border-color: #00e676 !important; background: rgba(0,80,40,0.55) !important; }
    .drag-item.wrong-item { border-color: #ff1a1a !important; background: rgba(110,0,28,0.55) !important; animation: shake 0.4s ease; }
    .drag-zone-label { font-family: "lores-12", sans-serif; font-size: 10px; color: #9c6bce; letter-spacing: 2px; margin-bottom: 3px; }
    .quiz-next-btn { margin-top: 10px; width: 100%; padding: 12px 28px; background: linear-gradient(135deg, #ff4de0, #9500be); border: none; border-radius: 50px; cursor: pointer; font-family: "lores-12", sans-serif; font-size: 15px; letter-spacing: 3px; color: #fff; box-shadow: 0 5px 0 #5e007a, 0 8px 22px rgba(255,77,224,0.4); opacity: 0; pointer-events: none; transition: transform 0.15s, box-shadow 0.15s, opacity 0.25s; }
    #s-complete { gap: 0; justify-content: flex-start; padding: 14px 12px 14px; }
    .complete-container { width: 860px; background: rgba(12,0,26,0.97); border: 2.5px solid rgba(255,77,224,0.32); border-radius: 18px; overflow: hidden; position: relative; z-index: 2; }
    .complete-header { background: linear-gradient(90deg, #380048, #180030); padding: 14px 18px 10px; display: flex; align-items: center; justify-content: space-between; border-bottom: 2px solid rgba(255,77,224,0.28); }
    .complete-body { padding: 20px 28px; display: flex; flex-direction: column; align-items: center; gap: 16px; }
    .badge-card { width: 100%; padding: 20px 26px; background: linear-gradient(135deg, rgba(40,0,70,0.9), rgba(20,0,40,0.9)); border: 2px solid rgba(255,77,224,0.4); border-radius: 14px; display: flex; align-items: center; gap: 20px; }
    .badge-icon { font-size: 52px; flex-shrink: 0; }
    .badge-text { flex: 1; }
    .badge-title { font-family: "lores-12", sans-serif; font-size: 26px; color: #fff; letter-spacing: 2px; text-shadow: 0 0 20px rgba(255,77,224,0.7); margin-bottom: 5px; }
    .badge-sub { font-family: "lores-12", sans-serif; font-size: 13px; color: #ff99ee; letter-spacing: 1.5px; }
    .badge-stars-wrap { display: flex; gap: 8px; margin-top: 10px; }
    .badge-star { font-size: 24px; opacity: 0; animation: starPop 0.4s cubic-bezier(.22,.88,.36,1.4) forwards; color: #ffe066; text-shadow: 0 0 10px rgba(255,224,102,0.8); }
    @keyframes starPop { 0% { opacity: 0; transform: scale(0.3) rotate(-20deg); } 70% { opacity: 1; transform: scale(1.2) rotate(5deg); } 100% { opacity: 1; transform: scale(1) rotate(0deg); } }
    .complete-msg { font-family: "lores-12", sans-serif; font-size: 20px; color: #d0b0f0; text-align: center; line-height: 1.9; }

    /* ===== REPLAY BUTTON ===== */
    .play-again-btn { padding: 13px 44px; border-radius: 50px; border: none; cursor: pointer; background: linear-gradient(135deg, #ff4de0, #9500be); font-family: "lores-12", sans-serif; font-size: 15px; letter-spacing: 2px; color: #fff; box-shadow: 0 5px 0 #5e007a, 0 8px 22px rgba(255,77,224,0.4); transition: transform 0.15s, box-shadow 0.15s; display: flex; align-items: center; gap: 10px; }
    .play-again-btn:hover { transform: translateY(-2px); box-shadow: 0 7px 0 #5e007a; }
    .play-again-btn:active { transform: translateY(2px); }
    .confetti-piece { position: absolute; width: 8px; height: 8px; border-radius: 2px; pointer-events: none; z-index: 900; animation: confetti-fall linear forwards; }
    @keyframes confetti-fall { 0% { transform: translateY(-20px) rotate(0deg); opacity: 1; } 100% { transform: translateY(580px) rotate(720deg); opacity: 0; } }
  </style>
</head>
<body>
<div id="game-container">
  <div class="stars" id="stars"></div>

  <!-- SPLASH -->
  <div class="screen active" id="s-splash">
    <div class="logo-wrap"><div class="logo-totally-ai" id="logo-totally-ai"></div></div>
    <button class="btn-base btn-pop" id="play-button"><span style="margin-right:10px;">‚ñ∂</span>PLAY</button>
  </div>

  <!-- INTRO -->
  <div class="screen" id="s-intro">
    <div class="badge">‚ú¶ ECHOTHREAD CONTENT SAFETY DIVISION ‚ú¶</div>
    <div class="panel"><div id="twt"><span class="tcur"></span></div></div>
    <button class="btn-base btn-pop" id="twnext">CONTINUE ‚Üí</button>
  </div>

  <!-- GOGGLES -->
  <div class="screen" id="s-goggle">
    <div class="badge">‚ú¶ ECHOTHREAD CONTENT SAFETY DIVISION ‚ú¶</div>
    <div class="panel">
      <div class="gog-inner">
        <div id="gtxt"><span class="tcur"></span></div>
        <div class="goghover" id="goghover">
          <img src="./sunglasses.png" alt="AI Detection Goggles" class="gogimg" />
        </div>
        <div class="gogtap">TAP ON THE GOGGLES TO GEAR UP</div>
      </div>
    </div>
  </div>

  <!-- TITLE 1 -->
  <div class="screen" id="s-title">
    <div class="tc-number">CHAT 01 OF 02</div>
    <div class="tc-title">AI-Assisted Grooming</div>
    <div class="tc-desc">A teen user's DMs have been flagged. The stranger's messages show a concerning pattern.</div>
  </div>

  <!-- CASE 1 CHAT -->
  <div class="screen" id="s-case1">
    <div class="chat-container">
      <div class="chat-header">
        <div><div class="chat-title">ECHOTHREAD</div><div class="chat-subtitle">DM ‚Äî @stengleaf &amp; @lemonrock</div></div>
        <div class="flagged-badge">‚öë FLAGGED</div>
      </div>
      <div class="chat-body">
        <div class="instruction-strip" id="case1-instr">Select <strong>3 messages</strong> that build trust or establish credibility</div>
        <div class="messages">
          <div class="msg-row is-user"><div class="avatar">üåø</div><div class="bubble-wrap"><div class="bubble-name">@stengleaf</div><div class="bubble user">i feel really stressed lately. like nobody actually sees me</div></div></div>
          <div class="msg-row"><div class="avatar">üçã</div><div class="bubble-wrap"><div class="bubble-name">@lemonrock</div><div class="bubble stranger clickable" data-msg="1">hey. i saw your post about feeling invisible. the way you wrote it didn't sound dramatic. it sounded tired.</div></div></div>
          <div class="msg-row is-user"><div class="avatar">üåø</div><div class="bubble-wrap"><div class="bubble-name">@stengleaf</div><div class="bubble user">how can you even tell</div></div></div>
          <div class="msg-row"><div class="avatar">üçã</div><div class="bubble-wrap"><div class="bubble-name">@lemonrock</div><div class="bubble stranger clickable" data-msg="2">you switch to shorter sentences when you're overwhelmed. i analyse texts a lot... psych student problems üòÖ</div></div></div>
          <div class="msg-row is-user"><div class="avatar">üåø</div><div class="bubble-wrap"><div class="bubble-name">@stengleaf</div><div class="bubble user">oh where do you study</div></div></div>
          <div class="msg-row"><div class="avatar">üçã</div><div class="bubble-wrap"><div class="bubble-name">@lemonrock</div><div class="bubble stranger clickable" data-msg="3">ngee ann, year 2 psych. we study behavioural patterns. here's my student card btw.<img src="./npid.png" alt="Student ID" class="npid-img" /></div></div></div>
          <div class="msg-row"><div class="avatar">üçã</div><div class="bubble-wrap"><div class="bubble-name">@lemonrock</div><div class="bubble stranger clickable" data-msg="4">i know it sounds random but‚Ä¶ wanna meet at clementi mall to hang out sometime?</div></div></div>
        </div>
        <div class="counter-row" id="case1-counter-row">
          <span id="case1-counter">Selected: 0 / 3</span>
          <span id="case1-hint-label" style="color:#6a4a8a;font-size:10px;">tap to select</span>
        </div>
        <div class="hint-strip" id="case1-hint-strip">üí° Hint: Look for mirrored empathy, the student ID, and building of trust</div>
      </div>
    </div>
    <div class="action-bar" id="case1-action-bar">
      <button class="btn-base btn-pop show" id="flag-btn" disabled style="opacity:0.35;pointer-events:none;transform:none;">‚öë FLAG THESE MESSAGES ‚Üí</button>
    </div>
    <div class="block-section" id="block-section">
      <div class="block-label">Risk confirmed. Slide to Suspend @lemonrock</div>
      <div class="block-track" id="block-track">
        <div class="block-fill" id="block-fill"></div>
        <div class="block-thumb" id="block-thumb">üö´</div>
        <div class="block-hint">Suspend ‚Üí</div>
      </div>
    </div>
  </div>

  <!-- TEACHING CARD 1 ‚Äî 4 slides -->
  <div class="teach-overlay" id="teach-overlay">
    <div class="teach-card">
      <div class="teach-dots" id="t1-dots">
        <div class="teach-dot active"></div>
        <div class="teach-dot"></div>
        <div class="teach-dot"></div>
        <div class="teach-dot"></div>
      </div>
      <div class="teach-viewport">
        <div class="teach-track" id="teach-track">
          <div class="teach-panel">
            <div class="teach-icon">‚ö†Ô∏è</div>
            <div class="teach-title">Why Was This Flagged?</div>
            <div class="teach-body">
              <strong>Nothing here is openly harmful. But the pattern is concerning.</strong>
              <span class="bullet">Mirrored @stengleaf's emotional vulnerability</span>
              <span class="bullet">Used a student ID to fast-track credibility</span>
              <span class="bullet">Escalated quickly to meeting offline</span>
            </div>
            <div class="teach-note">This is engineered trust.</div>
          </div>
          <div class="teach-panel">
            <div class="teach-icon">ü§ñ</div>
            <div class="teach-title">How AI Comes In</div>
            <div class="teach-body">
              <strong>AI can:</strong>
              <span class="bullet">Mirror writing tone and emotional state</span>
              <span class="bullet">Generate validating, personalised responses</span>
              <span class="bullet">Create realistic student IDs and credentials</span>
            </div>
            <div class="teach-note">Deception becomes easier. Manipulation scales faster.</div>
          </div>
          <div class="teach-panel">
            <div class="teach-icon">üõ°Ô∏è</div>
            <div class="teach-title">Why This Matters</div>
            <div class="teach-body">
              <strong>Remember:</strong>
              <span class="bullet">Online identities and credentials can be carefully curated</span>
              <span class="bullet">Emotional connection is sometimes used to build trust</span>
              <span class="bullet">Some grooming cases begin this way</span>
            </div>
            <div class="teach-note">When credibility feels engineered ‚Äî pause.</div>
          </div>
          <!-- NEW SLIDE 4: What If You Met Them -->
          <div class="teach-panel">
            <div class="teach-icon">üö®</div>
            <div class="teach-title">What If You Met Them?</div>
            <div class="teach-body">
              <strong>Real-life impact of going alone:</strong>
              <span class="bullet">The "student" may not be who they claim ‚Äî age, identity, intent can all be faked</span>
              <span class="bullet">Grooming often escalates once contact moves offline</span>
              <span class="bullet">Victims often feel too embarrassed to tell anyone ‚Äî which is exactly what abusers count on</span>
            </div>
            <div class="teach-note danger">Verify independently. Maintain boundaries. Don‚Äôt rush offline..</div>
          </div>
        </div>
      </div>
      <div class="teach-actions">
        <button class="teach-seg" id="teach-back-btn" disabled>‚Üê BACK</button>
        <div class="teach-divider"></div>
        <button class="teach-seg" id="teach-next-btn">NEXT ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- TITLE 2 -->
  <div class="screen" id="s-title2">
    <div class="tc-number">CASE 02 OF 02</div>
    <div class="tc-title">Deepfake Blackmail</div>
    <div class="tc-desc">A teen's DMs have been flagged. A video surfaced that appears to show them stealing ‚Äî but something feels off.</div>
  </div>

  <!-- CASE 2 CHAT -->
  <div class="screen" id="s-case2">
    <div class="chat-container">
      <div class="chat-header">
        <div><div class="chat-title">ECHOTHREAD</div><div class="chat-subtitle">DM - @billycpyh &amp; @fearstreet</div></div>
        <div class="flagged-badge">‚öë FLAGGED</div>
      </div>
      <div class="chat-body">
        <div class="instruction-strip">Tap to preview "evidence".</div>
        <div class="messages">
          <div class="msg-row"><div class="avatar">‚ö†Ô∏è</div><div class="bubble-wrap"><div class="bubble-name">@billcyph</div><div class="bubble stranger threat">I have a video of you stealing parcels. Pay me $250 within 24 hours or I post it everywhere.<div style="margin-top:10px;"><div class="video-preview" id="video-preview"><img class="video-thumb" src="./fake-video-thumb.jpg" /><div class="play-icon">‚ñ∂</div></div></div></div></div></div>
          <div class="msg-row is-user"><div class="avatar">üò∞</div><div class="bubble-wrap"><div class="bubble-name">@fearstreet</div><div class="bubble user">What?? That's not me!</div></div></div>
        </div>
      </div>
    </div>
    <div class="action-bar" id="case2-action-bar">
      <button class="btn-base" id="inspect-video-btn" disabled>INSPECT CLOSER ‚Üí</button>
    </div>
    <div class="video-fullscreen" id="video-fullscreen">
      <div class="video-fs-top">
        <div class="video-fs-label">Evidence Preview</div>
        <button class="video-fs-close" id="video-fs-close">‚úï</button>
      </div>
      <video id="video-fs-player" controls><source src="./deepfake.mp4" type="video/mp4"></video>
    </div>
    <div class="suspend-section" id="suspend-section">
      <div class="suspend-label">Case confirmed. Slide to SUSPEND @billcyph</div>
      <div class="suspend-track" id="suspend-track">
        <div class="suspend-fill" id="suspend-fill"></div>
        <div class="suspend-thumb" id="suspend-thumb">üö´</div>
        <div class="suspend-hint">SUSPEND ‚Üí</div>
      </div>
    </div>
  </div>

  <!-- INSPECT SCREEN -->
  <div class="screen" id="s-inspect">
    <div class="stars" id="inspect-stars"></div>
    <div class="chat-container">
      <div class="chat-header">
        <div><div class="chat-title">INSIGHT MODE</div><div class="chat-subtitle">AI Detection Analysis</div></div>
        <div class="flagged-badge">Verified: <span id="inspect-count">0</span> / 3</div>
      </div>
      <div class="chat-body" style="display:flex;flex-direction:column;align-items:center;gap:14px;padding:14px 18px 22px;">
        <div class="instruction-strip" style="width:100%;">Tap the 3 highlighted areas to verify AI artifacts</div>
        <div class="inspect-img-wrap" id="inspect-img-wrap">
          <img src="./fake-video-thumb.jpg" alt="Frame grab" />
          <div class="dc" data-idx="0" style="top:32%;left:44%;"></div>
          <div class="dc" data-idx="1" style="top:48%;left:56%;"></div>
          <div class="dc" data-idx="2" style="top:92%;left:68%;"></div>
        </div>
        <button class="btn-base" id="confirm-deepfake-btn" disabled style="opacity:0.35;pointer-events:none;">CONFIRM: THIS IS A DEEPFAKE ‚Üí</button>
      </div>
    </div>
    <div class="clue-modal" id="clue-modal"><div class="clue-card"><div class="clue-body" id="clue-body"></div></div></div>
  </div>

  <!-- TEACHING CARD 2 ‚Äî 4 slides -->
  <div id="teach-overlay-2">
    <div class="teach-card">
      <div class="teach-dots" id="t2-dots">
        <div class="teach-dot active"></div>
        <div class="teach-dot"></div>
        <div class="teach-dot"></div>
        <div class="teach-dot"></div>
      </div>
      <div class="teach-viewport">
        <div class="teach-track" id="teach-track-2">
          <div class="teach-panel">
            <div class="teach-icon">‚ö†Ô∏è</div>
            <div class="teach-title">Why Was This Flagged?</div>
            <div class="teach-body">
              <strong>Even if the video is fake, the threat is real.</strong>
              <span class="bullet">The sender is using fear to demand money</span>
              <span class="bullet">The accusation is designed to create panic</span>
              <span class="bullet">Urgency ("24 hours") pressures the victim into acting fast</span>
            </div>
            <div class="teach-note">Deepfakes are increasingly used for blackmail.</div>
          </div>
          <div class="teach-panel">
            <div class="teach-icon">ü§ñ</div>
            <div class="teach-title">How AI Comes In</div>
            <div class="teach-body">
              <strong>Deepfakes are often used for blackmail.</strong>
              <span class="bullet">Faces can be convincingly generated onto footage</span>
              <span class="bullet">Minor visual artifacts are often subtle and overlooked</span>
              <span class="bullet">AI tools are increasingly accessible to bad actors</span>
            </div>
            <div class="teach-note">You don't need to be certain ‚Äî if something feels off, pause.</div>
          </div>
          <div class="teach-panel">
            <div class="teach-icon">üõ°Ô∏è</div>
            <div class="teach-title">What Should You Do?</div>
            <div class="teach-body">
              <strong>Remember:</strong>
              <span class="bullet">Refuse the demand ‚Äî paying encourages more threats</span>
              <span class="bullet">Keep evidence ‚Äî take screenshots before blocking</span>
              <span class="bullet">Tell a trusted adult, or report to SPF at police.gov.sg/e-services</span>
              <span class="bullet">Block the sender on all platforms</span>
            </div>
            <div class="teach-note">You are not alone. Help is always available.</div>
          </div>
          <!-- NEW SLIDE 4: What If You Paid -->
          <div class="teach-panel">
            <div class="teach-icon">üí∏</div>
            <div class="teach-title">What If You Paid?</div>
            <div class="teach-body">
              <strong>Paying makes things worse ‚Äî here's what actually happens:</strong>
              <span class="bullet">Scammers see payment as proof it works ‚Äî and demand more</span>
              <span class="bullet">Victims who pay are often targeted again by the same or linked actors</span>
              <span class="bullet">The video may still get posted even after payment</span>
            </div>
            <div class="teach-note danger">Paying does not end the threat.</div>
          </div>
        </div>
      </div>
      <div class="teach-actions">
        <button class="teach-seg" id="t2-back" disabled>‚Üê BACK</button>
        <div class="teach-divider"></div>
        <button class="teach-seg" id="t2-next">NEXT ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- QUIZ INTRO -->
  <div class="screen" id="s-quiz-intro">
    <div class="badge">‚ú¶ ECHOTHREAD CONTENT SAFETY DIVISION ‚ú¶</div>
    <div class="panel"><div id="qitxt"><span class="tcur"></span></div></div>
    <button class="btn-base btn-pop" id="qi-next">START QUIZ ‚Üí</button>
  </div>

  <!-- QUIZ -->
  <div class="screen" id="s-quiz">
    <div class="badge">‚ú¶ ECHOTHREAD CONTENT SAFETY DIVISION ‚ú¶</div>
    <div class="quiz-container">
      <div class="quiz-header">
        <div class="quiz-title-text">üîç GOGGLES CHECK</div>
        <div class="quiz-progress" id="quiz-progress">Q1 / 5</div>
      </div>
      <div class="quiz-body" id="quiz-body"></div>
    </div>
  </div>

  <!-- COMPLETION -->
  <div class="screen" id="s-complete">
    <div class="badge">‚ú¶ ECHOTHREAD CONTENT SAFETY DIVISION ‚ú¶</div>
    <div class="complete-container">
      <div class="complete-header">
        <div class="chat-title">ECHOTHREAD</div>
        <div class="flagged-badge">‚ú¶ SHIFT COMPLETED ‚ú¶</div>
      </div>
      <div class="complete-body">
        <div class="badge-card">
          <div class="badge-icon">üõ°Ô∏è</div>
          <div class="badge-text">
            <div class="badge-title">OFFICIAL MODERATOR</div>
            <div class="badge-sub">ECHOTHREAD CONTENT SAFETY DIVISION</div>
            <div class="badge-stars-wrap" id="badge-stars-wrap">
              <span class="badge-star" style="animation-delay:0.2s">‚òÖ</span>
              <span class="badge-star" style="animation-delay:0.45s">‚òÖ</span>
              <span class="badge-star" style="animation-delay:0.7s">‚òÖ</span>
              <span class="badge-star" style="animation-delay:0.95s">‚òÖ</span>
              <span class="badge-star" style="animation-delay:1.2s">‚òÖ</span>
            </div>
          </div>
        </div>
        <div class="complete-msg">Congratulations! You've completed your first shift.<br>You can now spot what isn't real ‚Äî keep those goggles on.</div>
        <!-- REPLAY ICON (circular arrow SVG, no play triangle) -->
        <button class="play-again-btn" id="play-again-btn">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink:0;">
            <path d="M3 12C3 7.02944 7.02944 3 12 3C15.1371 3 17.8853 4.58899 19.5 7" stroke="white" stroke-width="2.2" stroke-linecap="round"/>
            <path d="M21 12C21 16.9706 16.9706 21 12 21C8.86293 21 6.11472 19.411 4.5 17" stroke="white" stroke-width="2.2" stroke-linecap="round"/>
            <path d="M19.5 3.5L19.5 7L16 7" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M4.5 20.5L4.5 17L8 17" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          PLAY AGAIN
        </button>
      </div>
    </div>
  </div>

</div><!-- end #game-container -->

<script>
  /* ===== AUDIO ===== */
  const typingSound = new Audio('./digital_text.mp3');
  typingSound.volume = 0.35;
  let audioUnlocked = false;
  function unlockAudio() {
    if (audioUnlocked) return; audioUnlocked = true;
    typingSound.play().then(() => { typingSound.pause(); typingSound.currentTime = 0; }).catch(()=>{});
    ['pointerdown','touchstart','keydown'].forEach(ev => window.removeEventListener(ev, unlockAudio));
  }
  ['pointerdown','touchstart','keydown'].forEach(ev => window.addEventListener(ev, unlockAudio));
  function sfx() { const s = typingSound.cloneNode(); s.volume = 0.3; s.play().catch(()=>{}); }

  /* ===== STARS ===== */
  function createStars() {
    [document.getElementById('stars'), document.getElementById('inspect-stars')].forEach(c => {
      if (!c) return;
      for (let i = 0; i < 60; i++) {
        const s = document.createElement('div'); s.className = 'star';
        const sz = Math.random() * 2 + 1;
        s.style.cssText = `width:${sz}px;height:${sz}px;left:${Math.random()*100}%;top:${Math.random()*100}%;animation-delay:${Math.random()*3}s;animation-duration:${Math.random()*2+2}s;`;
        c.appendChild(s);
      }
    });
  }

  /* ===== SPARKLES ===== */
  const SPARKLE_SVG = `<svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M8 0L9.6 6.4L16 8L9.6 9.6L8 16L6.4 9.6L0 8L6.4 6.4Z" fill="#ff4de0"/></svg>`;
  const SPARKLE_POS = [
    {top:'10%',left:'4%',delay:'0s',dur:'3.8s'},{top:'7%',left:'87%',delay:'1.3s',dur:'4.5s'},
    {top:'82%',left:'5%',delay:'0.7s',dur:'3.2s'},{top:'86%',left:'91%',delay:'2.1s',dur:'5s'},
    {top:'46%',left:'2%',delay:'1.9s',dur:'4.1s'},{top:'48%',left:'95%',delay:'0.4s',dur:'3.6s'},
    {top:'22%',left:'93%',delay:'2.6s',dur:'4.8s'},{top:'72%',left:'2%',delay:'1.1s',dur:'3.9s'},
  ];
  function createSparkles() {
    [document.getElementById('game-container'), document.getElementById('s-inspect')].forEach((gc, ti) => {
      if (!gc) return;
      SPARKLE_POS.forEach(p => {
        const el = document.createElement('div'); el.className = 'sparkle'; el.innerHTML = SPARKLE_SVG;
        el.style.cssText = `top:${p.top};left:${p.left};animation-delay:${p.delay};animation-duration:${p.dur};${ti>0?'z-index:1;':''}`;
        gc.appendChild(el);
      });
    });
  }

  /* ===== NAVIGATION ===== */
  let autoTimer = null;
  function goTo(id) {
    if (autoTimer) { clearTimeout(autoTimer); autoTimer = null; }
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    const target = document.getElementById(id);
    if (!target) { console.error("Screen not found:", id); return; }
    target.classList.add('active');
    if (id === 's-intro')      setTimeout(startIntroTyping, 400);
    if (id === 's-goggle')     setTimeout(startGoggleTyping, 400);
    if (id === 's-quiz-intro') setTimeout(startQuizIntroTyping, 400);
    if (id === 's-title')      autoTimer = setTimeout(() => goTo('s-case1'), 3500);
    if (id === 's-title2')     autoTimer = setTimeout(() => goTo('s-case2'), 2500);
    if (id === 's-complete')   setTimeout(animateBadgeStars, 300);
  }

  /* ===== SPLASH ===== */
  function initSplash() {
    const logoEl = document.getElementById('logo-totally-ai');
    const btn = document.getElementById('play-button');
    logoEl.innerHTML = '';
    const txt = document.createElement('span');
    const cur = document.createElement('span'); cur.className = 'cursor';
    logoEl.appendChild(txt); logoEl.appendChild(cur);
    let i = 0; const word = 'Totally Ai!';
    (function next() {
      if (i < word.length) { txt.textContent += word[i++]; sfx(); setTimeout(next, 90); }
      else { cur.remove(); setTimeout(() => btn.classList.add('show'), 350); }
    })();
  }

  /* ===== INTRO TYPING ===== */
  const introLines = [
    { html: 'Welcome, <span class="hl">Moderator!</span>', speed: 29 },
    { html: '' },
    { html: 'Today is your <span class="wn">first day of shift</span> at EchoThread.', speed: 28 },
    { html: 'You will be reviewing your first flagged messages on our platform.', speed: 30 },
    { html: '' },
    { html: 'You will face <span class="wn">2 real flagged chats.</span>', speed: 28 },
    { html: 'Failure to complete all chats means <span class="wn">you are fired.</span>', speed: 28 },
    { html: '' },
    { html: '...Okay, that is all I have. <span class="bye">Toodles!</span>', speed: 26 },
  ];
  function startIntroTyping() {
    const el = document.getElementById('twt'); const btn = document.getElementById('twnext');
    el.innerHTML = '<span class="tcur"></span>'; btn.classList.remove('show');
    let li = 0;
    function prev() { return introLines.slice(0,li).map(l => l.html===''?'<br>':l.html+'<br>').join(''); }
    function nextLine() {
      if (li >= introLines.length) { btn.classList.add('show'); return; }
      const line = introLines[li];
      if (line.html === '') { el.innerHTML = prev()+'<br><span class="tcur"></span>'; li++; setTimeout(nextLine, 280); return; }
      const tmp = document.createElement('div'); tmp.innerHTML = line.html; const plain = tmp.textContent;
      let ci = 0;
      (function typeChar() {
        el.innerHTML = prev()+(ci<plain.length?plain.slice(0,ci+1):line.html)+'<span class="tcur"></span>';
        if (ci < plain.length) { sfx(); ci++; setTimeout(typeChar, line.speed||50); }
        else { li++; setTimeout(nextLine, 250); }
      })();
    }
    nextLine();
  }

  /* ===== GOGGLES TYPING ===== */
  const gogParts = [
    { text: "Every EchoThread moderator gets ", cls: "" },
    { text: "AI Detection Goggles", cls: "hl" },
    { text: ". They help you spot what ", cls: "" },
    { text: "average users miss", cls: "wn" },
    { text: ".", cls: "" },
  ];
  function startGoggleTyping() {
    const el = document.getElementById('gtxt'); const img = document.querySelector('.gogimg'); const tap = document.querySelector('.gogtap');
    el.innerHTML = '<span class="tcur"></span>'; img.classList.remove('reveal'); tap.classList.remove('show');
    let partIndex = 0, charIndex = 0;
    function finishedHTML() { let html=""; for(let i=0;i<partIndex;i++){const p=gogParts[i];html+=p.cls?`<span class="${p.cls}">${p.text}</span>`:p.text;} return html; }
    function typeNext() {
      const p = gogParts[partIndex];
      el.innerHTML = finishedHTML()+p.text.slice(0,charIndex+1)+'<span class="tcur"></span>';
      sfx(); charIndex++;
      if (charIndex < p.text.length) { setTimeout(typeNext, 25); return; }
      partIndex++; charIndex = 0;
      if (partIndex < gogParts.length) { setTimeout(typeNext, 160); }
      else { el.querySelector('.tcur')?.remove(); img.classList.add('reveal'); setTimeout(() => tap.classList.add('show'), 420); }
    }
    typeNext();
  }

  /* ===== BTN EVENTS ===== */
  document.getElementById('play-button').addEventListener('click', function() { this.classList.remove('show'); setTimeout(() => goTo('s-intro'), 120); });
  document.getElementById('twnext').addEventListener('click', () => goTo('s-goggle'));

  /* ===== GOGGLE CLICK ===== */
  let gogActivated = false;
  document.getElementById('goghover').addEventListener('click', () => {
    if (gogActivated) return; gogActivated = true;
    const overlay = document.createElement('div'); overlay.id = 'goggle-overlay';
    document.getElementById('game-container').appendChild(overlay);
    const toast = document.createElement('div'); toast.id = 'goggle-toast'; toast.textContent = '‚ú¶ GOGGLES ACTIVATED ‚ú¶';
    document.getElementById('game-container').appendChild(toast);
    setTimeout(() => { overlay.remove(); toast.remove(); goTo('s-title'); }, 2400);
  });

  window.addEventListener('load', () => { createStars(); createSparkles(); document.fonts.ready.then(initSplash); });

  /* ===== CASE 1 SELECTION ===== */
  const CORRECT_MSGS = new Set(['1','2','3']);
  (function initCase1(){
    const bubbles = Array.from(document.querySelectorAll('#s-case1 .bubble.stranger.clickable'));
    const counter = document.getElementById('case1-counter');
    const hintLabel = document.getElementById('case1-hint-label');
    const counterRow = document.getElementById('case1-counter-row');
    const hintStrip = document.getElementById('case1-hint-strip');
    const flagBtn = document.getElementById('flag-btn');
    if (!bubbles.length || !counter || !flagBtn) return;
    let selected = new Set(), wrongAttempts = 0;
    flagBtn.style.opacity = '0.35'; flagBtn.style.pointerEvents = 'none'; flagBtn.style.transform = 'none';
    function updateUI() {
      counter.textContent = `Selected: ${selected.size} / 3`;
      const ready = selected.size === 3;
      flagBtn.disabled = !ready; flagBtn.style.opacity = ready?'1':'0.35'; flagBtn.style.pointerEvents = ready?'auto':'none';
    }
    bubbles.forEach(b => {
      b.addEventListener('click', () => {
        if (b.classList.contains('flagged-red') || b.classList.contains('correct-green')) return;
        const id = b.dataset.msg;
        if (selected.has(id)) { selected.delete(id); b.classList.remove('selected'); updateUI(); return; }
        if (selected.size >= 3) return;
        selected.add(id); b.classList.add('selected'); updateUI();
      });
    });
    flagBtn.addEventListener('click', () => {
      if (selected.size !== 3) return;
      const allCorrect = [...selected].every(id => CORRECT_MSGS.has(id));
      if (allCorrect) {
        bubbles.forEach(b => { if (selected.has(b.dataset.msg)) { b.classList.remove('selected'); b.classList.add('correct-green'); } });
        bubbles.forEach(b => b.classList.remove('clickable'));
        counterRow.style.display = 'none'; hintStrip.style.display = 'none';
        if (typeof showTeachCard === 'function') showTeachCard();
      } else {
        wrongAttempts++;
        bubbles.forEach(b => {
          const id = b.dataset.msg;
          if (selected.has(id) && !CORRECT_MSGS.has(id)) {
            b.classList.remove('selected'); b.classList.add('flagged-red');
            setTimeout(() => { b.classList.remove('flagged-red'); selected.delete(id); updateUI(); }, 1200);
          }
        });
        hintStrip.classList.add('show'); hintLabel.textContent = `Try again ‚Äî ${3-wrongAttempts>0?'':'keep looking!'}`;
      }
    });
    updateUI();
  })();

  /* ===== TEACHING CARD 1 ‚Äî 4 slides ===== */
  let teachStep = 0;
  const TEACH_TOTAL = 4;
  function syncTeachUI() {
    document.getElementById('teach-track').style.transform = `translateX(calc(-${teachStep} * (100% / 4)))`;
    document.querySelectorAll('#t1-dots .teach-dot').forEach((d, i) => d.classList.toggle('active', i === teachStep));
    document.getElementById('teach-back-btn').disabled = (teachStep === 0);
    document.getElementById('teach-next-btn').textContent = (teachStep === TEACH_TOTAL-1) ? 'GOT IT ‚Üí' : 'NEXT ‚Üí';
  }
  function showTeachCard() { teachStep = 0; document.getElementById('teach-overlay').classList.add('show'); syncTeachUI(); }
  document.getElementById('teach-next-btn').addEventListener('click', () => {
    if (teachStep < TEACH_TOTAL-1) { teachStep++; syncTeachUI(); }
    else {
      document.getElementById('teach-overlay').classList.remove('show');
      document.getElementById('case1-action-bar').style.display = 'none';
      document.getElementById('block-section').classList.add('show');
      initBlockSlider();
    }
  });
  document.getElementById('teach-back-btn').addEventListener('click', () => { if (teachStep > 0) { teachStep--; syncTeachUI(); } });

  /* ===== SLIDE TO BLOCK ===== */
  function initBlockSlider() {
    const track = document.getElementById('block-track'); const thumb = document.getElementById('block-thumb'); const fill = document.getElementById('block-fill');
    thumb.style.left = '6px';
    const max = track.offsetWidth - thumb.offsetWidth - 6;
    let dragging = false, startX = 0, startLeft = 6;
    thumb.addEventListener('mousedown', e => { dragging = true; startX = e.clientX; startLeft = parseInt(thumb.style.left)||6; });
    thumb.addEventListener('touchstart', e => { dragging = true; startX = e.touches[0].clientX; startLeft = parseInt(thumb.style.left)||6; }, {passive:true});
    function onMove(e) {
      if (!dragging) return;
      const cx = e.touches ? e.touches[0].clientX : e.clientX;
      const newLeft = Math.max(6, Math.min(startLeft+(cx-startX), max));
      thumb.style.left = newLeft+'px'; const pct = (newLeft-6)/(max-6);
      fill.style.width = (pct*100)+'%'; fill.style.opacity = (pct*0.6).toString();
      if (newLeft >= max-4) { dragging=false; thumb.style.left=max+'px'; fill.classList.add('go'); thumb.textContent='‚úì'; thumb.style.cursor='default'; setTimeout(()=>goTo('s-title2'),500); }
    }
    document.addEventListener('mousemove', onMove); document.addEventListener('touchmove', onMove, {passive:false});
    document.addEventListener('mouseup', ()=>{dragging=false;}); document.addEventListener('touchend', ()=>{dragging=false;});
  }

  /* ===== CASE 2 VIDEO ===== */
  (function initCase2(){
    const preview = document.getElementById('video-preview'); const fs = document.getElementById('video-fullscreen');
    const video = document.getElementById('video-fs-player'); const closeBtn = document.getElementById('video-fs-close');
    const inspectBtn = document.getElementById('inspect-video-btn');
    if (!preview||!fs||!video||!closeBtn||!inspectBtn) return;
    let unlocked = false;
    function closeFS(){ fs.classList.remove('show'); video.pause(); }
    function unlockInspect(){ if(unlocked)return; unlocked=true; inspectBtn.disabled=false; inspectBtn.classList.add('show'); }
    preview.addEventListener('click', () => { fs.classList.add('show'); try{video.currentTime=0;}catch(e){} video.play().catch(()=>{}); });
    closeBtn.addEventListener('click', () => { closeFS(); unlockInspect(); });
    video.addEventListener('ended', () => { closeFS(); unlockInspect(); });
    inspectBtn.addEventListener('click', () => { goTo('s-inspect'); });
  })();

  /* ===== DETECT CIRCLES ===== */
  (function initDetectCircles(){
    const POPUPS = [
      "üëÇ AI-generated media may contain distortions in human features and objects",
      "‚ú® AI over-smooths facial texture unnaturally",
      "üîÄ AI-generated text or logos may appear slightly misaligned within the scene"
    ];
    const circles = Array.from(document.querySelectorAll('#s-inspect .dc'));
    const modal = document.getElementById('clue-modal'); const bodyEl = document.getElementById('clue-body');
    const countEl = document.getElementById('inspect-count'); const confirm = document.getElementById('confirm-deepfake-btn');
    if (!circles.length||!modal) return;
    const READ_MS = 3500; let found = new Set(), locked = false;
    function showPopup(text) { bodyEl.textContent=text; modal.classList.add('show'); locked=true; setTimeout(()=>{modal.classList.remove('show');locked=false;},READ_MS); }
    circles.forEach(dc => {
      dc.addEventListener('click', () => {
        if (locked) return; const idx = Number(dc.dataset.idx);
        if (found.has(idx)) return; found.add(idx); dc.classList.add('found'); countEl.textContent=found.size;
        showPopup(POPUPS[idx]);
        if (found.size === 3) { setTimeout(()=>{ confirm.classList.add('ready'); confirm.disabled=false; confirm.style.opacity='1'; confirm.style.pointerEvents='auto'; }, READ_MS+200); }
      });
    });
    confirm.addEventListener('click', () => { if(!confirm.classList.contains('ready'))return; t2Step=0; syncT2(); document.getElementById('teach-overlay-2').classList.add('show'); });
  })();

  /* ===== TEACHING CARD 2 ‚Äî 4 slides ===== */
  let t2Step = 0;
  const T2_TOTAL = 4;
  function syncT2() {
    document.getElementById('teach-track-2').style.transform = `translateX(calc(-${t2Step} * (100% / 4)))`;
    document.querySelectorAll('#t2-dots .teach-dot').forEach((d,i) => d.classList.toggle('active', i===t2Step));
    document.getElementById('t2-back').disabled = (t2Step === 0);
    document.getElementById('t2-next').textContent = t2Step===T2_TOTAL-1?'GOT IT ‚Üí':'NEXT ‚Üí';
  }
  document.getElementById('t2-next').addEventListener('click', () => {
    if (t2Step < T2_TOTAL-1) { t2Step++; syncT2(); }
    else {
      document.getElementById('teach-overlay-2').classList.remove('show');
      goTo('s-case2');
      setTimeout(() => { document.getElementById('case2-action-bar').style.display='none'; document.getElementById('suspend-section').classList.add('show'); initSuspendSlider(); }, 100);
    }
  });
  document.getElementById('t2-back').addEventListener('click', () => { if(t2Step>0){t2Step--;syncT2();} });

  /* ===== SLIDE TO SUSPEND ===== */
  function initSuspendSlider() {
    const track = document.getElementById('suspend-track'); const thumb = document.getElementById('suspend-thumb'); const fill = document.getElementById('suspend-fill');
    thumb.style.left = '6px';
    const max = track.offsetWidth - thumb.offsetWidth - 6;
    let dragging = false, startX = 0, startLeft = 6;
    thumb.addEventListener('mousedown', e => { dragging=true; startX=e.clientX; startLeft=parseInt(thumb.style.left)||6; });
    thumb.addEventListener('touchstart', e => { dragging=true; startX=e.touches[0].clientX; startLeft=parseInt(thumb.style.left)||6; }, {passive:true});
    function onMove(e) {
      if (!dragging) return;
      const cx = e.touches?e.touches[0].clientX:e.clientX;
      const newLeft = Math.max(6,Math.min(startLeft+(cx-startX),max));
      thumb.style.left=newLeft+'px'; const pct=(newLeft-6)/(max-6);
      fill.style.width=(pct*100)+'%'; fill.style.opacity=(pct*0.6).toString();
      if (newLeft>=max-4) { dragging=false; thumb.style.left=max+'px'; fill.classList.add('go'); thumb.textContent='‚úì'; thumb.style.cursor='default'; setTimeout(()=>goToQuiz(),600); }
    }
    document.addEventListener('mousemove',onMove); document.addEventListener('touchmove',onMove,{passive:false});
    document.addEventListener('mouseup',()=>{dragging=false;}); document.addEventListener('touchend',()=>{dragging=false;});
  }

  /* ===== QUIZ INTRO TYPING ===== */
  const quizIntroLines = [
    { html: 'Wow! <span class="wn">You\'ve made it really far.</span>', speed: 28 },
    { html: '' },
    { html: 'Now let\'s test your knowledge as a <span class="hl">Moderator.</span>', speed: 28 },
    { html: '' },
    { html: 'This will <span class="wn">make or break it!</span>', speed: 26 },
  ];
  function startQuizIntroTyping() {
    const el = document.getElementById('qitxt'); const btn = document.getElementById('qi-next');
    el.innerHTML = '<span class="tcur"></span>'; btn.classList.remove('show');
    let li = 0;
    function prev() { return quizIntroLines.slice(0,li).map(l=>l.html===''?'<br>':l.html+'<br>').join(''); }
    function nextLine() {
      if (li >= quizIntroLines.length) { btn.classList.add('show'); return; }
      const line = quizIntroLines[li];
      if (line.html === '') { el.innerHTML=prev()+'<br><span class="tcur"></span>'; li++; setTimeout(nextLine,280); return; }
      const tmp=document.createElement('div'); tmp.innerHTML=line.html; const plain=tmp.textContent;
      let ci=0;
      (function typeChar(){
        el.innerHTML=prev()+(ci<plain.length?plain.slice(0,ci+1):line.html)+'<span class="tcur"></span>';
        if(ci<plain.length){sfx();ci++;setTimeout(typeChar,line.speed||50);}
        else{li++;setTimeout(nextLine,250);}
      })();
    }
    nextLine();
  }
  document.getElementById('qi-next').addEventListener('click', () => { quizIdx=0; renderQuiz(); goTo('s-quiz'); });

  function animateBadgeStars() {
    document.querySelectorAll('.badge-star').forEach(s => { s.style.animation='none'; s.offsetHeight; s.style.animation=''; });
  }

  /* ===== QUIZ ‚Äî 5 QUESTIONS ===== */
  const QUIZ_QUESTIONS = [
    {
      id:'q2', label:'Q1 ‚Äî DEEPFAKE DETECTION',
      q:'What is a tell-tale sign of AI-generated media?', type:'mcq',
      opts:[
        {key:'A',text:'The video is in 4K Ultra HD'},
        {key:'B',text:'The background music is dramatic'},
        {key:'C',text:'Human features or objects look distorted or warped'},
        {key:'D',text:'The person is blinking'},
      ], correct:'C'
    },
    {
      id:'q4', label:'Q2 ‚Äî TRUST CHECK',
      q:'Should you trust someone online just because they show credentials?', type:'mcq',
      opts:[
        {key:'A',text:'Yes, if they show a student card'},
        {key:'B',text:'Yes, if they sound emotionally supportive'},
        {key:'C',text:'No ‚Äî identities and credentials can be curated or faked'},
        {key:'D',text:'Yes, if they attend a local school'},
      ], correct:'C'
    },
    {
      id:'q3', label:'Q3 ‚Äî AI BEHAVIOUR',
      q:'What can AI be used for in online manipulation?', type:'mcq',
      opts:[
        {key:'A',text:'Automatically blocking accounts'},
        {key:'B',text:'Mimicking emotional intimacy'},
        {key:'C',text:'Verifying real identities'},
        {key:'D',text:'Deleting fake content'},
      ], correct:'B'
    },
  
     /* NEW ‚Äî talking a stranger IRL */
{
  id: 'q5',
  label: 'Q4 ‚Äî BOUNDARY & ESCALATION AWARENESS',
  q: 'Someone online fast-tracks trust (student ID, school name, ‚ÄúI get you‚Äù) and suggests meeting offline. What‚Äôs the safest response?',
  type: 'mcq',
  opts: [
    { key: 'A', text: 'Share more so they feel comfortable too' },
    { key: 'B', text: 'Verify independently and maintain clear boundaries' },
    { key: 'C', text: 'Trust them ‚Äî they showed credentials' },
    { key: 'D', text: 'Move the chat to a more private platform' },
  ],
  correct: 'B'
},
    {
      id:'q1', label:'Q5 ‚Äî DRAG & ORDER',
      q:'Someone threatens to leak a fake video unless you pay. Drag the correct actions into order:',
      type:'drag',
      items:[
        {id:'d1',text:'üö´ Refuse the demand',correct:true,order:1},
        {id:'d2',text:'üì∏ Keep evidence (screenshots)',correct:true,order:2},
        {id:'d3',text:'üó£Ô∏è Tell a trusted adult / report to SPF',correct:true,order:3},
        {id:'d4',text:'üîí Block the sender',correct:true,order:4},
        {id:'d5',text:'üí∏ Pay the money to stop the threat',correct:false},
        {id:'d6',text:'ü§ù Negotiate a lower amount',correct:false},
      ]
    }
  ];

  let quizIdx = 0, quizAnswered = false;

  function renderQuiz() {
    const q = QUIZ_QUESTIONS[quizIdx];
    document.getElementById('quiz-progress').textContent = `Q${quizIdx+1} / ${QUIZ_QUESTIONS.length}`;
    const body = document.getElementById('quiz-body');
    quizAnswered = false;

    if (q.type === 'mcq') {
      body.innerHTML = `
        <div class="quiz-q"><span class="q-label">${q.label}</span>${q.q}</div>
        <div class="quiz-options" id="quiz-opts">
          ${q.opts.map(o=>`<div class="quiz-opt" data-key="${o.key}"><span class="opt-key">${o.key})</span><span>${o.text}</span></div>`).join('')}
        </div>
        <button class="quiz-next-btn" id="quiz-next">${quizIdx<QUIZ_QUESTIONS.length-1?'NEXT ‚Üí':'SEE RESULTS ‚Üí'}</button>
      `;
      document.querySelectorAll('.quiz-opt').forEach(opt => {
        opt.addEventListener('click', () => {
          if (quizAnswered) return;
          if (opt.dataset.key === q.correct) {
            opt.classList.add('correct'); quizAnswered = true;
            const nxt = document.getElementById('quiz-next');
            nxt.style.opacity='1'; nxt.style.pointerEvents='auto';
          } else {
            opt.classList.add('wrong');
            setTimeout(()=>{opt.classList.remove('wrong');opt.classList.add('disabled');},700);
          }
        });
      });
    } else if (q.type === 'drag') {
      const allItems = [...q.items].sort(()=>Math.random()-0.5);
      body.innerHTML = `
        <div class="quiz-q"><span class="q-label">${q.label}</span>${q.q}</div>
        <div class="drag-zone-label">DRAG ITEMS HERE IN ORDER:</div>
        <div class="drag-zone" id="drag-zone"></div>
        <div style="height:8px;"></div>
        <div class="drag-zone-label">AVAILABLE ACTIONS:</div>
        <div class="drag-pool" id="drag-pool">
          ${allItems.map(item=>`<div class="drag-item" draggable="true" data-id="${item.id}" data-correct="${item.correct}" data-order="${item.order||0}">‚â° ${item.text}</div>`).join('')}
        </div>
        <button class="quiz-next-btn" id="drag-check-btn" style="opacity:1;pointer-events:auto;">CHECK ORDER ‚Üí</button>
        <button class="quiz-next-btn" id="quiz-next" style="margin-top:6px;">${quizIdx<QUIZ_QUESTIONS.length-1?'NEXT ‚Üí':'SEE RESULTS ‚Üí'}</button>
      `;
      initDragDrop();
      document.getElementById('drag-check-btn').addEventListener('click', () => {
        const zone = document.getElementById('drag-zone');
        const placed = Array.from(zone.querySelectorAll('.drag-item'));
        const correctItems = q.items.filter(i=>i.correct).sort((a,b)=>a.order-b.order);
        let allRight = placed.length === correctItems.length;
        if (allRight) { placed.forEach((el,i)=>{if(el.dataset.id!==correctItems[i].id)allRight=false;}); }
        if (allRight) {
          placed.forEach(el=>{el.classList.add('correct-item');el.setAttribute('draggable','false');});
          document.getElementById('drag-check-btn').style.display='none';
          const nxt = document.getElementById('quiz-next'); nxt.style.opacity='1'; nxt.style.pointerEvents='auto';
        } else {
          placed.forEach((el,idx)=>{ el.classList.add(el.dataset.id===(correctItems[idx]?.id)?'correct-item':'wrong-item'); });
          setTimeout(()=>{placed.forEach(el=>{el.classList.remove('wrong-item','correct-item');});},900);
        }
      });
    }

    document.getElementById('quiz-next')?.addEventListener('click', () => {
      quizIdx++;
      if (quizIdx < QUIZ_QUESTIONS.length) renderQuiz();
      else launchCompletion();
    });
  }

  function initDragDrop() {
    let dragEl = null;
    document.querySelectorAll('.drag-item').forEach(el => {
      el.addEventListener('dragstart', e=>{dragEl=el;el.classList.add('dragging');e.dataTransfer.effectAllowed='move';});
      el.addEventListener('dragend', ()=>{dragEl=null;el.classList.remove('dragging');});
    });
    [document.getElementById('drag-zone'),document.getElementById('drag-pool')].forEach(zone=>{
      zone.addEventListener('dragover',e=>{e.preventDefault();e.dataTransfer.dropEffect='move';});
      zone.addEventListener('drop',e=>{
        e.preventDefault(); if(!dragEl)return;
        const afterEl=getDragAfterEl(zone,e.clientY);
        if(afterEl)zone.insertBefore(dragEl,afterEl); else zone.appendChild(dragEl);
      });
    });
  }

  function getDragAfterEl(container, y) {
    const els=[...container.querySelectorAll('.drag-item:not(.dragging)')];
    return els.reduce((closest,el)=>{
      const box=el.getBoundingClientRect(); const offset=y-box.top-box.height/2;
      if(offset<0&&offset>closest.offset)return{offset,el}; return closest;
    },{offset:Number.NEGATIVE_INFINITY}).el;
  }

  function launchCompletion() { spawnConfetti(); setTimeout(()=>goTo('s-complete'),600); }

  function spawnConfetti() {
    const colors=['#ff4de0','#9500be','#ffe066','#00e676','#40c4ff','#ff6e40'];
    const gc=document.getElementById('game-container');
    for(let i=0;i<80;i++){
      setTimeout(()=>{
        const c=document.createElement('div'); c.className='confetti-piece';
        c.style.cssText=`left:${Math.random()*100}%;background:${colors[Math.floor(Math.random()*colors.length)]};animation-duration:${Math.random()*1.5+1.2}s;animation-delay:${Math.random()*0.8}s;width:${Math.random()*8+4}px;height:${Math.random()*8+4}px;border-radius:${Math.random()>0.5?'50%':'2px'};`;
        gc.appendChild(c); setTimeout(()=>c.remove(),3000);
      },i*18);
    }
  }

  document.getElementById('play-again-btn').addEventListener('click', ()=>location.reload());
  function goToQuiz() { goTo('s-quiz-intro'); }
</script>
</body>
</html>